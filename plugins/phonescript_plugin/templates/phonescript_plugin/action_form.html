{% extends "mysite/base.html" %}

{% load bootstrap3 %}

{% block page_specific_javascript %}

  $("#id_topic_tags, #id_type_tags").chosen({width: '100%'})

  function shownewscript_constituent(count) {
      next = count + 1;
      id = "#con_script_" + next;
      $(id).toggle();
  }

  function shownewscript_universal(count) {
      next = count + 1;
      id = "#uni_script_" + next;
      $(id).toggle();
  }

{% endblock page_specific_javascript %}

{% block content %}

<div class="row">
  <div class="col-sm-10 col-sm-offset-1">
    <h2>{% if object %} Edit {% else %} Create {% endif %} a PhoneScript action</h2>
    <p>With a phonescript action, you can provide a list of scripts for people to use
      when calling Congress.  We use location data provided by users to only show them
      the relevant scipts.</p>
    <p>You can add two different kinds of scripts to your actions. The first are
      <span class="text-primary"><b>constituent scripts</b></span>.  With these scripts,
      you can specify what kind of scripts a constituent gets for their representative
      based on conditions like 'are they a Democrat' or 'are they on X committee'.</p>
    <p>We know you might want everyone to call a given representative.  So you
      can also add <span class="text-primary"><b>universal scripts</b></span>.  All of
      these scripts will show up for everyone.</p>
    <p>Pick an option below to get started.</p>

      <ul class="nav nav-pills">
        <li><a href="#constituent" data-toggle="tab" aria-expanded="false">
            Add Constituent Scripts
            {% if constituent_forms.is_bound and not constituent_forms.is_valid %}
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>
            {% endif %}
            </a>
        </li>
        <li><a href="#default" data-toggle="tab" aria-expanded="false">
            Set a Default Script
            {% if default_form.errors %}
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>
            {% endif %}
            </a>
        </li>
        <li><a href="#universal" data-toggle="tab" aria-expanded="false">
            Add Universal Scripts
            {% if universal_forms.is_bound and not universal_forms.is_valid %}
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>
            {% endif %}
            </a>
        </li>
        <li><a href="#details" data-toggle="tab" aria-expanded="false">
            Add General Action Details
            {% if form.errors %}
                <i class="fa fa-exclamation-triangle text-danger" aria-hidden="true"></i>
            {% endif %}
            </a>
        </li>
      </ul>

      <form class="form-horizontal" action="" method="post" id="action-form">
        {% csrf_token %}

      <div class="tab-content">
        <div class="tab-pane" id="constituent">
          {% include "phonescript_plugin/constituent_script_include.html" with forms=constituent_forms %}
        </div>
        <div class="tab-pane" id="default">
          {% include "phonescript_plugin/default_script_include.html" with form=default_form %}
        </div>
        <div class="tab-pane" id="universal">
          {% include "phonescript_plugin/universal_script_include.html" with forms=universal_forms %}
        </div>
        <div class="tab-pane" id="details">
          {% include "phonescript_plugin/action_details_include.html" with form=form %}
        </div>
      </div>

    </div>
  </div>

  <div class="row extra-padding-top">
    <div class="col-sm-10 col-sm-offset-1">

      {% buttons %}
          {% bootstrap_button "Cancel" button_type="link" button_class="btn-default" %}
          {% bootstrap_button "Submit" button_type="submit" button_class="btn-primary action-submit-button" icon="star" %}
      {% endbuttons %}

      </form>

    </div>
</div>

{% endblock content %}

{% block page_specific_css %}
  {{ form.media }}
{% endblock page_specific_css %}
